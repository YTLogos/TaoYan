<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Tao Yan">

  
  
  
    
  
  <meta name="description" content="

简介

本文内容基本是来源于STHDA，这是一份十分详细的ggplot2使用指南，因此我将其翻译成中文，一是有助于我自己学习理解，另外其他R语言爱好者或者可视化爱好者可以用来学习。翻译过程肯定不能十全十美，各位读者有建议或改进的话，十分欢迎发Email(tyan@zju.edu.cn)给我。">

  
  <link rel="alternate" hreflang="en-us" href="https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/">

  


  

  
  
  
  <meta name="theme-color" content="#E13D3D">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/paraiso-light.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/paraiso-light.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arapey:400,400i|Karla:400,700|Roboto+Mono|Mrs+Saint+Delafield|Kaushan+Script|Playball&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.271ffa4140fad041464911a0b7fff4cf.css">

  
    
    
    
    
      
    
    
    
    <link rel="stylesheet" href="/css/academic.948c91384be7a6e3e086b01b867a93a8.css">
  

  
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@TaoYANLogos">
  <meta property="twitter:creator" content="@TaoYANLogos">
  
  <meta property="og:site_name" content="Tao Yan">
  <meta property="og:url" content="https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/">
  <meta property="og:title" content="ggplot2高效实用指南 | Tao Yan">
  <meta property="og:description" content="

简介

本文内容基本是来源于STHDA，这是一份十分详细的ggplot2使用指南，因此我将其翻译成中文，一是有助于我自己学习理解，另外其他R语言爱好者或者可视化爱好者可以用来学习。翻译过程肯定不能十全十美，各位读者有建议或改进的话，十分欢迎发Email(tyan@zju.edu.cn)给我。"><meta property="og:image" content="https://taoyan.netlify.com/img/avatar.jpg">
  <meta property="twitter:image" content="https://taoyan.netlify.com/img/avatar.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2017-09-19T08:29:46&#43;00:00">
    
    <meta property="article:modified_time" content="2017-09-19T08:29:46&#43;00:00">
  

  

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#E13D3D",
          "text": "#fbf9f4"
        },
        "button": {
          "background": "#fbf9f4",
          "text": "#E13D3D"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://cookies.insites.com"
      }
    })});
</script>



  





  <title>ggplot2高效实用指南 | Tao Yan</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Tao Yan</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/CV.pdf"><span>CV</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">ggplot2高效实用指南</h1>

  

  
    



<meta content="2017-09-19 08:29:46 &#43;0000 UTC" itemprop="datePublished">
<meta content="2017-09-19 08:29:46 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>Sep 19, 2017</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    16 min read
  </span>
  

  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="">可视化</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/&amp;text=ggplot2%e9%ab%98%e6%95%88%e5%ae%9e%e7%94%a8%e6%8c%87%e5%8d%97" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/&amp;t=ggplot2%e9%ab%98%e6%95%88%e5%ae%9e%e7%94%a8%e6%8c%87%e5%8d%97" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=ggplot2%e9%ab%98%e6%95%88%e5%ae%9e%e7%94%a8%e6%8c%87%e5%8d%97&amp;body=https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/&amp;title=ggplot2%e9%ab%98%e6%95%88%e5%ae%9e%e7%94%a8%e6%8c%87%e5%8d%97" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=ggplot2%e9%ab%98%e6%95%88%e5%ae%9e%e7%94%a8%e6%8c%87%e5%8d%97%20https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://taoyan.netlify.com/post/2017-09-19.ggplot2%E9%AB%98%E6%95%88%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97/&amp;title=ggplot2%e9%ab%98%e6%95%88%e5%ae%9e%e7%94%a8%e6%8c%87%e5%8d%97" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>
    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      <p><img src="https://github.com/YTLogos/Pic_blog/blob/master/emJBf4A306.png?raw=true" alt="mark" /></p>

<h2 id="简介">简介</h2>

<p>本文内容基本是来源于<a href="http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization" target="_blank">STHDA</a>，这是一份十分详细的<strong>ggplot2</strong>使用指南，因此我将其翻译成中文，一是有助于我自己学习理解，另外其他R语言爱好者或者可视化爱好者可以用来学习。翻译过程肯定不能十全十美，各位读者有建议或改进的话，十分欢迎发<strong>Email</strong>(tyan@zju.edu.cn)给我。</p>

<p><a href="https://ggplot2.tidyverse.org/reference/" target="_blank"><strong>ggplot2</strong></a>是由<strong>Hadley Wickham</strong>创建的一个十分强大的可视化R包。按照<strong>ggplot2</strong>的绘图理念，Plot(图)= data(数据集)+ Aesthetics(美学映射)+ Geometry(几何对象)：</p>

<ul>
<li>data: 数据集，主要是data frame；</li>
<li>Aesthetics: 美学映射，比如将变量映射给x,y坐标轴，或者映射给颜色、大小、形状等图形属性；</li>
<li>Geometry: 几何对象，比如柱形图、直方图、散点图、线图、密度图等。</li>
</ul>

<p>在<strong>ggplot2</strong>中有两个主要绘图函数：qplot()以及ggplot()。</p>

<ul>
<li>qplot(): 顾名思义，快速绘图；</li>
<li>ggplot()：此函数才是<strong>ggplot2</strong>的精髓，远比qplot()强大，可以一步步绘制十分复杂的图形。</li>
</ul>

<p>由<strong>ggplot2</strong>绘制出来的ggplot图可以作为一个变量，然后由print()显示出来。</p>

<h2 id="图形类型">图形类型</h2>

<p>根据数据集，<strong>ggplot2</strong>提供不同的方法绘制图形，主要是为下面几类数据类型提供绘图方法：</p>

<ul>
<li>一个变量x: 连续或离散</li>
<li>两个变量x&amp;y：连续和(或)离散</li>
<li>连续双变量分布x&amp;y: 都是连续</li>
<li>误差棒</li>
<li>地图</li>
<li>三变量</li>
</ul>

<h2 id="安装及加载">安装及加载</h2>

<p>安装<strong>ggplot2</strong>提供三种方式：</p>

<pre><code>#直接安装tidyverse，一劳永逸（推荐,数据分析大礼包）
install.packages(&quot;tidyverse&quot;)
#直接安装ggplot2
install.packages(&quot;ggplot2&quot;)
#从Github上安装最新的版本，先安装devtools(如果没安装的话)
devtools::install_github(&quot;tidyverse/ggplot2&quot;)
</code></pre>

<p>加载</p>

<pre><code class="language-r">library(ggplot2)
</code></pre>

<h2 id="数据准备">数据准备</h2>

<blockquote>
<p>数据集应该数据框data.frame</p>
</blockquote>

<p>本文将使用数据集<strong>mtcars</strong>。</p>

<pre><code class="language-r">#load the data set
data(mtcars)
df &lt;- mtcars[, c(&quot;mpg&quot;,&quot;cyl&quot;,&quot;wt&quot;)]
#将cyl转为因子型factor
df$cyl &lt;- as.factor(df$cyl)
head(df)
</code></pre>

<pre><code>##                    mpg cyl    wt
## Mazda RX4         21.0   6 2.620
## Mazda RX4 Wag     21.0   6 2.875
## Datsun 710        22.8   4 2.320
## Hornet 4 Drive    21.4   6 3.215
## Hornet Sportabout 18.7   8 3.440
## Valiant           18.1   6 3.460
</code></pre>

<h2 id="qplot">qplot()</h2>

<p>qplot()类似于R基本绘图函数plot(),可以快速绘制常见的几种图形：散点图、箱线图、小提琴图、直方图以及密度曲线图。其绘图格式为：</p>

<pre><code>qplot(x, y=NULL, data, geom=&quot;auto&quot;)
</code></pre>

<p>其中：</p>

<ul>
<li>x,y: 根据需要绘制的图形使用;</li>
<li>data：数据集;</li>
<li>geom：几何图形，变量x,y同时指定的话默认为散点图，只指定x的话默认为直方图。</li>
</ul>

<h3 id="散点图">散点图</h3>

<pre><code class="language-r">qplot(x=mpg, y=wt, data=df, geom = &quot;point&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DlJaE4eke3.png?raw=true" alt="" />
也可以添加平滑曲线</p>

<pre><code class="language-r">qplot(x=mpg, y=wt, data = df, geom = c(&quot;point&quot;, &quot;smooth&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/i3lHIh2jdD.png?raw=true" alt="" />
还有其他参数可以修改，比如点的形状、大小、颜色等</p>

<pre><code class="language-r">#将变量cyl映射给颜色和形状
qplot(x=mpg, y=wt, data = df, colour=cyl, shape=cyl)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/D6Aflkkhab.png?raw=true" alt="" /></p>

<h3 id="箱线图-小提琴图-点图">箱线图、小提琴图、点图</h3>

<pre><code class="language-r">#构造数据集
set.seed(1234)
wdata &lt;- data.frame(
  sex=factor(rep(c(&quot;F&quot;, &quot;M&quot;), each=200)),
  weight=c(rnorm(200, 55), rnorm(200, 58))
)
head(wdata)
</code></pre>

<pre><code>##   sex   weight
## 1   F 53.79293
## 2   F 55.27743
## 3   F 56.08444
## 4   F 52.65430
## 5   F 55.42912
## 6   F 55.50606
</code></pre>

<p>箱线图</p>

<pre><code class="language-r">qplot(sex, weight, data = wdata, geom = &quot;boxplot&quot;, fill=sex)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/92K2e20idg.png?raw=true" alt="" /></p>

<p>小提琴图</p>

<pre><code class="language-r">qplot(sex, weight, data = wdata, geom = &quot;violin&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/3m8H660Cl9.png?raw=true" alt="" /></p>

<p>点图</p>

<pre><code class="language-r">qplot(sex, weight, data = wdata, geom = &quot;dotplot&quot;, stackdir=&quot;center&quot;, binaxis=&quot;y&quot;, dotsize=0.5, color=sex)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Hb7G4J8875.png?raw=true" alt="" /></p>

<h3 id="直方图-密度图">直方图、密度图</h3>

<p>直方图</p>

<pre><code class="language-r">qplot(weight, data = wdata, geom = &quot;histogram&quot;, fill=sex)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/gd448CcLDb.png?raw=true" alt="" /></p>

<p>密度图</p>

<pre><code class="language-r">qplot(weight, data = wdata, geom = &quot;density&quot;, color=sex, linetype=sex)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/dl77b5BDdm.png?raw=true" alt="" /></p>

<h2 id="ggplot">ggplot()</h2>

<p>上文中的qplot()绘制散点图：</p>

<pre><code>qplot(x=mpg, y=wt, data=df, geom = &quot;point&quot;)
</code></pre>

<p>在ggplot()中完全可以如下实现：</p>

<pre><code class="language-r">ggplot(data=df, aes(x=mpg, y=wt))+
  geom_point()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/80fkCC4Kgh.png?raw=true" alt="" /></p>

<p>改变点形状、大小、颜色等属性</p>

<pre><code class="language-r">ggplot(data=df, aes(x=mpg, y=wt))+geom_point(color=&quot;blue&quot;, size=2, shape=23)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/6LbL12Jmhm.png?raw=true" alt="" /></p>

<p>绘图过程中常常要用到转换(transformation),这时添加图层的另一个方法是用stat_*()函数。
下例中的geom_density()与stat_density()是等价的</p>

<pre><code>ggplot(wdata, aes(x=weight))+geom_density()
</code></pre>

<p>等价于</p>

<pre><code class="language-r">ggplot(wdata, aes(x=weight))+stat_density()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/D3ca6EAf3F.png?raw=true" alt="" /></p>

<blockquote>
<p>对于每一种几何图形。<strong>ggplot2</strong> 基本都提供了 geom<em>*()*和 stat</em><em>()</em></p>
</blockquote>

<h3 id="一个变量-连续型">一个变量：连续型</h3>

<p>使用数据集wdata，先计算出不同性别的体重平均值</p>

<pre><code class="language-r">library(plyr)
mu &lt;- ddply(wdata, &quot;sex&quot;, summarise, grp.mean=mean(weight))
</code></pre>

<p>先绘制一个图层a,后面逐步添加图层</p>

<pre><code class="language-r">a &lt;- ggplot(wdata, aes(x=weight))
</code></pre>

<p>可能添加的图层有：</p>

<ul>
<li>对于一个连续变量：

<ul>
<li>面积图geom_area()</li>
<li>密度图geom_density()</li>
<li>点图geom_dotplot()</li>
<li>频率多边图geom_freqpoly()</li>
<li>直方图geom_histogram()</li>
<li>经验累积密度图stat_ecdf()</li>
<li>QQ图stat_qq()</li>
</ul></li>
<li>对于一个离散变量：

<ul>
<li>条形图geom_bar()
<br /></li>
</ul></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/gcLBC7cG47.png?raw=true" alt="" /></p>

<h4 id="面积图">面积图</h4>

<pre><code class="language-r">a+geom_area(stat = &quot;bin&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/J288ccH2m5.png?raw=true" alt="" /></p>

<p>改变颜色</p>

<pre><code class="language-r">a+geom_area(aes(fill=sex), stat = &quot;bin&quot;, alpha=0.6)+
  theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/LIj4mJbKb2.png?raw=true" alt="" /></p>

<blockquote>
<p>注意：y轴默认为变量weight的数量即count，如果y轴要显示密度，可用以下代码：</p>
</blockquote>

<pre><code class="language-r">a+geom_area(aes(y=..density..), stat = &quot;bin&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/kkCc85KCeJ.png?raw=true" alt="" /></p>

<p>可以通过修改不同属性如透明度、填充颜色、大小、线型等自定义图形：</p>

<h4 id="密度图">密度图</h4>

<p>使用以下函数：</p>

<ul>
<li>geom_density():绘制密度图</li>
<li>geom_vline():添加竖直线</li>

<li><p>scale_color_manual():手动修改颜色</p>

<pre><code class="language-r">a+geom_density()
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/c1EL7I2a49.png?raw=true" alt="" /></p>

<p>根据sex修改颜色，将sex映射给line颜色</p>

<pre><code class="language-r">a+geom_density(aes(color=sex))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/72Ahbf7K6h.png?raw=true" alt="" /></p>

<p>修改填充颜色以及透明度</p>

<pre><code class="language-r">a+geom_density(aes(fill=sex), alpha=0.4)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/ejijLE9IfG.png?raw=true" alt="" /></p>

<p>添加均值线以及手动修改颜色</p>

<pre><code class="language-r">a+geom_density(aes(color=sex))+
  geom_vline(data=mu, aes(xintercept=grp.mean, color=sex), linetype=&quot;dashed&quot;)+
  scale_color_manual(values = c(&quot;red&quot;, &quot;blue&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/mAFhH7lleK.png?raw=true" alt="" /></p>

<h4 id="点图">点图</h4>

<pre><code class="language-r">a+geom_dotplot()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/H1mDL0HCJI.png?raw=true" alt="" /></p>

<p>将sex映射给颜色</p>

<pre><code class="language-r">a+geom_dotplot(aes(fill=sex))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/6bfHaEcBAl.png?raw=true" alt="" /></p>

<p>手动修改颜色</p>

<pre><code class="language-r">a+geom_dotplot(aes(fill=sex))+
  scale_fill_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/kiE9Lci30h.png?raw=true" alt="" /></p>

<h4 id="频率多边图">频率多边图</h4>

<pre><code class="language-r">a+geom_freqpoly()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/K40Fch448J.png?raw=true" alt="" /></p>

<p>y轴显示为密度</p>

<pre><code class="language-r">a+geom_freqpoly(aes(y=..density..))+
  theme_minimal()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/CgCf1eAgf8.png?raw=true" alt="" /></p>

<p>修改颜色以及线型</p>

<pre><code class="language-r">a+geom_freqpoly(aes(color=sex, linetype=sex))+
  theme_minimal()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/jaaBibcFjH.png?raw=true" alt="" /></p>

<h4 id="直方图">直方图</h4>

<pre><code class="language-r">a+geom_histogram()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/bHilai3a9l.png?raw=true" alt="" /></p>

<p>将sex映射给线颜色</p>

<pre><code class="language-r">a+geom_histogram(aes(color=sex), fill=&quot;white&quot;, position = &quot;dodge&quot;)+theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/eD7iLDJId1.png?raw=true" alt="" /></p>

<h4 id="经验累积密度图">经验累积密度图</h4>

<pre><code class="language-r">a+stat_ecdf()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/f83Imkm4jm.png?raw=true" alt="" /></p>

<h4 id="qq图">QQ图</h4>

<pre><code class="language-r">ggplot(data = mtcars, aes(sample=mpg))+stat_qq()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/e7G7hbeLID.png?raw=true" alt="" /></p>

<h3 id="一个离散变量">一个离散变量</h3>

<pre><code class="language-r">#加载数据集
data(mpg)
b &lt;- ggplot(mpg, aes(x=fl))
b+geom_bar()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/b4FJFb7H99.png?raw=true" alt="" /></p>

<p>修改填充颜色</p>

<pre><code class="language-r">b+geom_bar(fill=&quot;steelblue&quot;, color=&quot;black&quot;)+theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/ih6I2ammG4.png?raw=true" alt="" /></p>

<h3 id="两个变量-x-y皆连续">两个变量：x,y皆连续</h3>

<p>使用数据集mtcars， 先创建一个ggplot图层</p>

<pre><code class="language-r">b &lt;- ggplot(data = mtcars, aes(x=wt, y=mpg))
</code></pre>

<p>可能添加的图层有：</p>

<ul>
<li>geom_point():散点图</li>
<li>geom_smooth():平滑线</li>
<li>geom_quantile():分位线</li>
<li>geom_rug():边际地毯线</li>
<li>geom_jitter():避免重叠</li>
<li>geom_text():添加文本注释</li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/ld1EAJgd88.png?raw=true" alt="" /></p>

<h4 id="散点图-1">散点图</h4>

<pre><code class="language-r">b+geom_point()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/796GlJi3Al.png?raw=true" alt="" /></p>

<p>将变量cyl映射给点的颜色和形状</p>

<pre><code class="language-r">b + geom_point(aes(color = factor(cyl), shape = factor(cyl)))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/J6dfJ1EL33.png?raw=true" alt="" /></p>

<p>自定义颜色</p>

<pre><code class="language-r">b+geom_point(aes(color=factor(cyl), shape=factor(cyl)))+
  scale_color_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))+theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/3695bEj0Ha.png?raw=true" alt="" /></p>

<h4 id="平滑线">平滑线</h4>

<p>可以添加回归曲线</p>

<pre><code class="language-r">b+geom_smooth()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/1hJGKGeLc2.png?raw=true" alt="" /></p>

<p>散点图+回归线</p>

<pre><code class="language-r">b+geom_point()+
  geom_smooth(method = &quot;lm&quot;, se=FALSE)#去掉置信区间
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Gl47fkb2c2.png?raw=true" alt="" /></p>

<p>使用loess方法</p>

<pre><code class="language-r">b+geom_point()+
  geom_smooth(method = &quot;loess&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/6jaCLAL3Fc.png?raw=true" alt="" /></p>

<p>将变量映射给颜色和形状</p>

<pre><code class="language-r">b+geom_point(aes(color=factor(cyl), shape=factor(cyl)))+
  geom_smooth(aes(color=factor(cyl), shape=factor(cyl)), method = &quot;lm&quot;, se=FALSE, fullrange=TRUE)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/7hjfJ89K4c.png?raw=true" alt="" /></p>

<h4 id="分位线">分位线</h4>

<pre><code class="language-r">ggplot(data = mpg, aes(cty, hwy))+
  geom_point()+geom_quantile()+
  theme_minimal()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/l0F005kgih.png?raw=true" alt="" /></p>

<h4 id="边际地毯线">边际地毯线</h4>

<p>使用数据集<strong>faithful</strong></p>

<pre><code class="language-r">ggplot(data = faithful, aes(x=eruptions, y=waiting))+
  geom_point()+geom_rug()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/7H7BlJE35k.png?raw=true" alt="" /></p>

<h4 id="避免重叠">避免重叠</h4>

<p>实际上<code>geom_jitter()</code>是<code>geom_point(position=&quot;jitter&quot;)</code>的简称,下面使用数据集<strong>mpg</strong></p>

<pre><code class="language-r">p &lt;- ggplot(data = mpg, aes(displ, hwy))
p+geom_point()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Ad2aBaaEED.png?raw=true" alt="" />
增加抖动防止重叠</p>

<pre><code class="language-r">p+geom_jitter(width = 0.5, height = 0.5)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DmKBbIGK2c.png?raw=true" alt="" /></p>

<p>其中两个参数：</p>

<ul>
<li>width：x轴方向的抖动幅度</li>
<li>height：y轴方向的抖动幅度</li>
</ul>

<h4 id="文本注释">文本注释</h4>

<p>参数label用来指定注释标签</p>

<pre><code class="language-r">b+geom_text(aes(label=rownames(mtcars)))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/L6CaLD26ga.png?raw=true" alt="" /></p>

<h3 id="两个变量-连续二元分布">两个变量：连续二元分布</h3>

<p>使用数据集<strong>diamonds</strong></p>

<pre><code class="language-r">head(diamonds[, c(&quot;carat&quot;, &quot;price&quot;)])
</code></pre>

<pre><code>## # A tibble: 6 x 2
##   carat price
##   &lt;dbl&gt; &lt;int&gt;
## 1  0.23   326
## 2  0.21   326
## 3  0.23   327
## 4  0.29   334
## 5  0.31   335
## 6  0.24   336
</code></pre>

<p>创建ggplot图层,后面再逐步添加图层</p>

<pre><code class="language-r">c &lt;- ggplot(data=diamonds, aes(carat, price))
</code></pre>

<p>可添加的图层有：</p>

<ul>
<li>geom_bin2d(): 二维封箱热图</li>
<li>geom_hex(): 六边形封箱图</li>
<li>geom_density_2d(): 二维等高线密度图</li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/mIdJKh6F1G.png?raw=true" alt="" /></p>

<h4 id="二维封箱热图">二维封箱热图</h4>

<p><code>geom_bin2d()</code>将点的数量用矩形封装起来，通过颜色深浅来反映点密度</p>

<pre><code class="language-r">c+geom_bin2d()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/BgC3g377mE.png?raw=true" alt="" />
设置bin的数量</p>

<pre><code class="language-r">c+geom_bin2d(bins=150)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/4ejegHkcbF.png?raw=true" alt="" /></p>

<h4 id="六边形封箱图">六边形封箱图</h4>

<p>geom_hex()依赖于另一个R包<strong>hexbin</strong>，所以没安装的先安装：</p>

<pre><code>install.packages(&quot;hexbin&quot;)
</code></pre>

<pre><code class="language-r">library(hexbin)
c+geom_hex()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/f9Fbl2IAKj.png?raw=true" alt="" /></p>

<p>修改bin的数目</p>

<pre><code class="language-r">c+geom_hex(bins=10)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/bIc44CGdC8.png?raw=true" alt="" /></p>

<h4 id="二维等高线密度图">二维等高线密度图</h4>

<pre><code class="language-r">sp &lt;- ggplot(faithful, aes(x=eruptions, y=waiting))
sp+geom_point()+ geom_density_2d()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/imG9fLLlb6.png?raw=true" alt="" /></p>

<h3 id="两个变量-连续函数">两个变量：连续函数</h3>

<p>主要是如何通过线来连接两个变量，使用数据集<strong>economics</strong>。</p>

<pre><code class="language-r">head(economics)
</code></pre>

<pre><code>## # A tibble: 6 x 6
##         date   pce    pop psavert uempmed unemploy
##       &lt;date&gt; &lt;dbl&gt;  &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;int&gt;
## 1 1967-07-01 507.4 198712    12.5     4.5     2944
## 2 1967-08-01 510.5 198911    12.5     4.7     2945
## 3 1967-09-01 516.3 199113    11.7     4.6     2958
## 4 1967-10-01 512.9 199311    12.5     4.9     3143
## 5 1967-11-01 518.1 199498    12.5     4.7     3066
## 6 1967-12-01 525.8 199657    12.1     4.8     3018
</code></pre>

<p>先创建一个ggplot图层，后面逐步添加图层</p>

<pre><code class="language-r">d &lt;- ggplot(data = economics, aes(x=date, y=unemploy))
</code></pre>

<p>可添加的图层有：</p>

<ul>
<li>geom_area():面积图</li>
<li>geom_line()：折线图</li>
<li>geom_step(): 阶梯图</li>
</ul>

<h4 id="面积图-1">面积图</h4>

<pre><code class="language-r">d+geom_area()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/dj4fHa6Kh2.png?raw=true" alt="" /></p>

<h4 id="线图">线图</h4>

<pre><code class="language-r">d+geom_line()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DhLc531J92.png?raw=true" alt="" /></p>

<h4 id="阶梯图">阶梯图</h4>

<pre><code class="language-r">set.seed(1111)
ss &lt;- economics[sample(1:nrow(economics), 20),]
ggplot(ss, aes(x=date, y=unemploy))+
  geom_step()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/l5lHl5944G.png?raw=true" alt="" /></p>

<h3 id="两个变量-x离散-y连续">两个变量：x离散，y连续</h3>

<p>使用数据集<strong>ToothGrowth</strong>,其中的变量len(Tooth length)是连续变量，dose是离散变量。</p>

<pre><code class="language-r">ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)
head(ToothGrowth)
</code></pre>

<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5
</code></pre>

<p>创建图层</p>

<pre><code class="language-r">e &lt;- ggplot(data = ToothGrowth, aes(x=dose, y=len))
</code></pre>

<p>可添加的图层有：
* geom_boxplot(): 箱线图
* geom_violin()：小提琴图
* geom_dotplot()：点图
* geom_jitter(): 带状图
* geom_line(): 线图
* geom_bar(): 条形图</p>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/3F447J6d7L.png?raw=true" alt="" /></p>

<h4 id="箱线图">箱线图</h4>

<pre><code class="language-r">e+geom_boxplot()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/37J7f7hfCJ.png?raw=true" alt="" /></p>

<p>添加有缺口的箱线图</p>

<pre><code class="language-r">e+geom_boxplot(notch = TRUE)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/952cibHB9E.png?raw=true" alt="" /></p>

<p>按dose分组映射给颜色</p>

<pre><code class="language-r">e+geom_boxplot(aes(color=dose))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/15dJjbIGkB.png?raw=true" alt="" /></p>

<p>将dose映射给填充颜色</p>

<pre><code class="language-r">e+geom_boxplot(aes(fill=dose))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Am1A6Efaa6.png?raw=true" alt="" /></p>

<p>按supp进行分类并映射给填充颜色</p>

<pre><code class="language-r">ggplot(ToothGrowth, aes(x=dose, y=len))+ geom_boxplot(aes(fill=supp))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/jfFFF1Hh99.png?raw=true" alt="" /></p>

<h4 id="小提琴图">小提琴图</h4>

<pre><code class="language-r">e+geom_violin(trim = FALSE)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/fG1DmbmaIB.png?raw=true" alt="" /></p>

<p>添加中值点</p>

<pre><code class="language-r">e+geom_violin(trim = FALSE)+
  stat_summary(fun.data = mean_sdl, fun.args = list(mult=1), 
               geom=&quot;pointrange&quot;, color=&quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/GAkDaEHJe2.png?raw=true" alt="" /></p>

<p>与箱线图结合</p>

<pre><code class="language-r">e+geom_violin(trim = FALSE)+
  geom_boxplot(width=0.2)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/igef2H376K.png?raw=true" alt="" /></p>

<p>将dose映射给颜色进行分组</p>

<pre><code class="language-r">e+geom_violin(aes(color=dose), trim = FALSE)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/g6G0aI5DaE.png?raw=true" alt="" /></p>

<h4 id="点图-1">点图</h4>

<pre><code class="language-r">e+geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/60aB2FKkBj.png?raw=true" alt="" /></p>

<p>添加中值点</p>

<pre><code class="language-r">e + geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;) + 
  stat_summary(fun.data=mean_sdl, color = &quot;red&quot;,geom = &quot;pointrange&quot;,fun.args=list(mult=1))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/B1A5h69HDF.png?raw=true" alt="" /></p>

<p>与箱线图结合</p>

<pre><code class="language-r">e + geom_boxplot() + 
  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;) 
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/JkebcfeiHH.png?raw=true" alt="" /></p>

<p>添加小提琴图</p>

<pre><code class="language-r">e + geom_violin(trim = FALSE) +
  geom_dotplot(binaxis='y', stackdir='center')
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DGm19F7hde.png?raw=true" alt="" /></p>

<p>将dose映射给颜色以及填充色</p>

<pre><code class="language-r">e + geom_dotplot(aes(color = dose, fill = dose), 
                 binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/AGABHiI43E.png?raw=true" alt="" /></p>

<h4 id="带状图">带状图</h4>

<p>带状图是一种一维散点图，当样本量很小时，与箱线图相当</p>

<pre><code class="language-r">e + geom_jitter(position=position_jitter(0.2))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/KE0EHFl7h0.png?raw=true" alt="" /></p>

<p>添加中值点</p>

<pre><code class="language-r">e + geom_jitter(position=position_jitter(0.2)) + 
  stat_summary(fun.data=&quot;mean_sdl&quot;,  fun.args = list(mult=1), 
               geom=&quot;pointrange&quot;, color = &quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/GF9c4kHDKI.png?raw=true" alt="mark" /></p>

<p>与点图结合</p>

<pre><code class="language-r">e + geom_jitter(position=position_jitter(0.2)) + 
  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;) 
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/238j5KGmEB.png?raw=true" alt="mark" /></p>

<p>与小提琴图结合</p>

<pre><code class="language-r">e + geom_violin(trim = FALSE) +
  geom_jitter(position=position_jitter(0.2))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/lEADE3fA1h.png?raw=true" alt="mark" /></p>

<p>将dose映射给颜色和形状</p>

<pre><code class="language-r">e +  geom_jitter(aes(color = dose, shape = dose),
                 position=position_jitter(0.2))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/7lKfKkE5d6.png?raw=true" alt="mark" /></p>

<h4 id="线图-1">线图</h4>

<pre><code class="language-r">#构造数据集
df &lt;- data.frame(supp=rep(c(&quot;VC&quot;, &quot;OJ&quot;), each=3),
                dose=rep(c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),2),
                len=c(6.8, 15, 33, 4.2, 10, 29.5))
head(df)
</code></pre>

<pre><code>##   supp dose  len
## 1   VC D0.5  6.8
## 2   VC   D1 15.0
## 3   VC   D2 33.0
## 4   OJ D0.5  4.2
## 5   OJ   D1 10.0
## 6   OJ   D2 29.5
</code></pre>

<p>将supp映射线型</p>

<pre><code class="language-r">ggplot(df, aes(x=dose, y=len, group=supp)) +
  geom_line(aes(linetype=supp))+
  geom_point()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Bjl125A2Im.png?raw=true" alt="mark" /></p>

<p>修改线型、点的形状以及颜色</p>

<pre><code class="language-r">ggplot(df, aes(x=dose, y=len, group=supp)) +
  geom_line(aes(linetype=supp, color = supp))+
  geom_point(aes(shape=supp, color = supp))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/j9e39B9cKB.png?raw=true" alt="mark" /></p>

<h4 id="条形图">条形图</h4>

<pre><code class="language-r">#构造数据集
df &lt;- data.frame(dose=c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),
                len=c(4.2, 10, 29.5))
head(df)
</code></pre>

<pre><code>##   dose  len
## 1 D0.5  4.2
## 2   D1 10.0
## 3   D2 29.5
</code></pre>

<pre><code class="language-r">df2 &lt;- data.frame(supp=rep(c(&quot;VC&quot;, &quot;OJ&quot;), each=3),
                dose=rep(c(&quot;D0.5&quot;, &quot;D1&quot;, &quot;D2&quot;),2),
                len=c(6.8, 15, 33, 4.2, 10, 29.5))
head(df2)
</code></pre>

<pre><code>##   supp dose  len
## 1   VC D0.5  6.8
## 2   VC   D1 15.0
## 3   VC   D2 33.0
## 4   OJ D0.5  4.2
## 5   OJ   D1 10.0
## 6   OJ   D2 29.5
</code></pre>

<p>创建图层</p>

<pre><code class="language-r">f &lt;- ggplot(df, aes(x = dose, y = len))
f + geom_bar(stat = &quot;identity&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/FF7A37l9j4.png?raw=true" alt="mark" /></p>

<p>修改填充色以及添加标签</p>

<pre><code class="language-r">f + geom_bar(stat=&quot;identity&quot;, fill=&quot;steelblue&quot;)+
  geom_text(aes(label=len), vjust=-0.3, size=3.5)+
  theme_minimal()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/hBa9871IE9.png?raw=true" alt="mark" /></p>

<p>将dose映射给条形图颜色</p>

<pre><code class="language-r">f + geom_bar(aes(color = dose),
             stat=&quot;identity&quot;, fill=&quot;white&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/HIGAAJLiFl.png?raw=true" alt="mark" /></p>

<p>修改填充色</p>

<pre><code class="language-r">f + geom_bar(aes(fill = dose), stat=&quot;identity&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/LGFlfJGmHi.png?raw=true" alt="mark" /></p>

<p>将变量supp映射给填充色，从而达到分组效果</p>

<pre><code class="language-r">g &lt;- ggplot(data=df2, aes(x=dose, y=len, fill=supp)) 
g + geom_bar(stat = &quot;identity&quot;)#position默认为stack
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/dLGm6lij04.png?raw=true" alt="mark" /></p>

<p>修改position为dodge</p>

<pre><code class="language-r">g + geom_bar(stat=&quot;identity&quot;, position=position_dodge())
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Di23jj9kC9.png?raw=true" alt="mark" /></p>

<h3 id="两个变量-x-y皆离散">两个变量：x、y皆离散</h3>

<p>使用数据集diamonds中的两个离散变量color以及cut</p>

<pre><code class="language-r">ggplot(diamonds, aes(cut, color)) +
  geom_jitter(aes(color = cut), size = 0.5)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/c8Fh5DI7cE.png?raw=true" alt="mark" /></p>

<h3 id="两个变量-绘制误差图">两个变量：绘制误差图</h3>

<pre><code class="language-r">df &lt;- ToothGrowth
df$dose &lt;- as.factor(df$dose)
head(df)
</code></pre>

<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5
</code></pre>

<p>绘制误差图需要知道均值以及标准误，下面这个函数用来计算每组的均值以及标准误。</p>

<pre><code class="language-r">data_summary &lt;- function(data, varname, grps){
  require(plyr)
  summary_func &lt;- function(x, col){
    c(mean = mean(x[[col]], na.rm=TRUE),
      sd = sd(x[[col]], na.rm=TRUE))
  }
  data_sum&lt;-ddply(data, grps, .fun=summary_func, varname)
  data_sum &lt;- rename(data_sum, c(&quot;mean&quot; = varname))
 return(data_sum)
}
</code></pre>

<p>计算均值以及标准误</p>

<pre><code class="language-r">df2 &lt;- data_summary(df, varname=&quot;len&quot;, grps= &quot;dose&quot;)
# Convert dose to a factor variable
df2$dose=as.factor(df2$dose)
head(df2)
</code></pre>

<pre><code>##   dose    len       sd
## 1  0.5 10.605 4.499763
## 2    1 19.735 4.415436
## 3    2 26.100 3.774150
</code></pre>

<p>创建图层</p>

<pre><code class="language-r">f &lt;- ggplot(df2, aes(x = dose, y = len, 
                     ymin = len-sd, ymax = len+sd))
</code></pre>

<p>可添加的图层有：</p>

<ul>
<li>geom_crossbar(): 空心柱，上中下三线分别代表ymax、mean、ymin</li>
<li>geom_errorbar(): 误差棒</li>
<li>geom_errorbarh(): 水平误差棒</li>
<li>geom_linerange()：竖直误差线</li>
<li>geom_pointrange()：中间为一点的误差线</li>
</ul>

<p>具体如下：</p>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/521m2AHCDg.png?raw=true" alt="" /></p>

<h4 id="geom-crossbar">geom_crossbar()</h4>

<pre><code class="language-r">f+geom_crossbar()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/18EIA26lgI.png?raw=true" alt="mark" /></p>

<p>将dose映射给颜色</p>

<pre><code class="language-r">f+geom_crossbar(aes(color=dose))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/jH5eDIHjHL.png?raw=true" alt="mark" /></p>

<p>自定义颜色</p>

<pre><code class="language-r">f+geom_crossbar(aes(color=dose))+
  scale_color_manual(values = c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))+theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/jcBCFdKlmH.png?raw=true" alt="mark" /></p>

<p>修改填充色</p>

<pre><code class="language-r">f+geom_crossbar(aes(fill=dose))+
  scale_fill_manual(values = c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))+
  theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/6c5A4l9d2D.png?raw=true" alt="mark" /></p>

<p>通过将supp映射给颜色实现分组，可以利用函数stat_summary()来计算mean和sd</p>

<pre><code class="language-r">f &lt;- ggplot(df, aes(x=dose, y=len, color=supp))
f+stat_summary(fun.data = mean_sdl, fun.args = list(mult=1), geom=&quot;crossbar&quot;, width=0.6, position = position_dodge(0.8))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/3e3Ic9486G.png?raw=true" alt="mark" /></p>

<h4 id="误差棒">误差棒</h4>

<pre><code class="language-r">f &lt;- ggplot(df2, aes(x=dose, y=len, ymin=len-sd, ymax=len+sd))
</code></pre>

<p>将dose映射给颜色</p>

<pre><code class="language-r">f+geom_errorbar(aes(color=dose), width=0.2)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/HLJe8aLajg.png?raw=true" alt="mark" /></p>

<p>与线图结合</p>

<pre><code class="language-r">f+geom_line(aes(group=1))+
  geom_errorbar(width=0.15)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/2E0aKa6GgJ.png?raw=true" alt="mark" /></p>

<p>与条形图结合，并将变量dose映射给颜色</p>

<pre><code class="language-r">f+geom_bar(aes(color=dose), stat = &quot;identity&quot;, fill=&quot;white&quot;)+
  geom_errorbar(aes(color=dose), width=0.1)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/1GllA47ajF.png?raw=true" alt="mark" /></p>

<h4 id="水平误差棒">水平误差棒</h4>

<pre><code class="language-r">#构造数据集
df2 &lt;- data_summary(ToothGrowth, varname=&quot;len&quot;, grps = &quot;dose&quot;)
df2$dose &lt;- as.factor(df2$dose)
head(df2)
</code></pre>

<pre><code>##   dose    len       sd
## 1  0.5 10.605 4.499763
## 2    1 19.735 4.415436
## 3    2 26.100 3.774150
</code></pre>

<p>创建图层</p>

<pre><code class="language-r">f &lt;- ggplot(data = df2, aes(x=len, y=dose,xmin=len-sd, xmax=len+sd))
</code></pre>

<p>参数xmin与xmax用来设置水平误差棒</p>

<pre><code class="language-r">f+geom_errorbarh()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/2KAK9FgCDF.png?raw=true" alt="mark" /></p>

<p>通过映射实现分组</p>

<pre><code class="language-r">f+geom_errorbarh(aes(color=dose))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/G3cJmg13EI.png?raw=true" alt="mark" /></p>

<h4 id="geom-linerange-与geom-pointrange">geom_linerange()与geom_pointrange()</h4>

<pre><code class="language-r">f &lt;- ggplot(df2, aes(x=dose, y=len, ymin=len-sd, ymax=len+sd))
</code></pre>

<p>line range</p>

<pre><code class="language-r">f+geom_linerange()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/95BJEFgb1c.png?raw=true" alt="mark" /></p>

<p>point range</p>

<pre><code class="language-r">f+geom_pointrange()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/5kAAd2dhJl.png?raw=true" alt="mark" /></p>

<h4 id="点图-误差棒">点图+误差棒</h4>

<pre><code class="language-r">g &lt;- ggplot(df, aes(x=dose, y=len))+
  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)
</code></pre>

<p>添加geom_crossbar()</p>

<pre><code class="language-r">g+stat_summary(fun.data = mean_sdl, fun.args = list(mult=1), geom=&quot;crossbar&quot;, color=&quot;red&quot;, width=0.1)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/gb1G7K8D25.png?raw=true" alt="mark" /></p>

<p>添加geom_errorbar()</p>

<pre><code class="language-r">g + stat_summary(fun.data=mean_sdl, fun.args = list(mult=1), 
        geom=&quot;errorbar&quot;, color=&quot;red&quot;, width=0.2) +
  stat_summary(fun.y=mean, geom=&quot;point&quot;, color=&quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/HBjmlf502b.png?raw=true" alt="mark" /></p>

<p>添加geom_pointrange()</p>

<pre><code class="language-r">g + stat_summary(fun.data=mean_sdl, fun.args = list(mult=1), 
                 geom=&quot;pointrange&quot;, color=&quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/E3K5E0cg9B.png?raw=true" alt="mark" /></p>

<h3 id="两个变量-地图绘制">两个变量：地图绘制</h3>

<p><strong>ggplot2</strong>提供了绘制地图的函数<code>geom_map()</code>，依赖于包<strong>maps</strong>提供地理信息。
安装<strong>map</strong></p>

<pre><code>install.paclages(&quot;maps&quot;)
</code></pre>

<p>下面将绘制美国地图，数据集采用<strong>USArrests</strong></p>

<pre><code class="language-r">library(maps)
head(USArrests)
</code></pre>

<pre><code>##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58 21.2
## Alaska       10.0     263       48 44.5
## Arizona       8.1     294       80 31.0
## Arkansas      8.8     190       50 19.5
## California    9.0     276       91 40.6
## Colorado      7.9     204       78 38.7
</code></pre>

<p>对数据进行整理一下,添加一列state</p>

<pre><code class="language-r">crimes &lt;- data.frame(state=tolower(rownames(USArrests)), USArrests)
head(crimes)
</code></pre>

<pre><code>##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58 21.2
## Alaska       10.0     263       48 44.5
## Arizona       8.1     294       80 31.0
## Arkansas      8.8     190       50 19.5
## California    9.0     276       91 40.6
## Colorado      7.9     204       78 38.7
</code></pre>

<pre><code>#数据重铸
library(reshape2)
crimesm &lt;- melt(crimes, id=1)
head(crimesm)
</code></pre>

<pre><code>##        state variable value
## 1    alabama   Murder  13.2
## 2     alaska   Murder  10.0
## 3    arizona   Murder   8.1
## 4   arkansas   Murder   8.8
## 5 california   Murder   9.0
## 6   colorado   Murder   7.9
</code></pre>

<pre><code>map_data &lt;- map_data(&quot;state&quot;)
#绘制地图，使用Murder进行着色
ggplot(crimes, aes(map_id=state))+
  geom_map(aes(fill=Murder), map=map_data)+
  expand_limits(x=map_data$long, y=map_data$lat)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/I05fI783fH.png?raw=true" alt="mark" /></p>

<h3 id="三个变量">三个变量</h3>

<p>使用数据集<strong>mtcars</strong>，首先绘制一个相关性图</p>

<pre><code class="language-r">#构造数据
df &lt;- mtcars[, c(1,3,4,5,6,7)]
head(df)
</code></pre>

<pre><code>##                    mpg disp  hp drat    wt  qsec
## Mazda RX4         21.0  160 110 3.90 2.620 16.46
## Mazda RX4 Wag     21.0  160 110 3.90 2.875 17.02
## Datsun 710        22.8  108  93 3.85 2.320 18.61
## Hornet 4 Drive    21.4  258 110 3.08 3.215 19.44
## Hornet Sportabout 18.7  360 175 3.15 3.440 17.02
## Valiant           18.1  225 105 2.76 3.460 20.22
</code></pre>

<pre><code>cormat &lt;- round(cor(df), 2)
cormat_melt &lt;- melt(cormat)
head(cormat)
</code></pre>

<pre><code>##        mpg  disp    hp  drat    wt  qsec
## mpg   1.00 -0.85 -0.78  0.68 -0.87  0.42
## disp -0.85  1.00  0.79 -0.71  0.89 -0.43
## hp   -0.78  0.79  1.00 -0.45  0.66 -0.71
## drat  0.68 -0.71 -0.45  1.00 -0.71  0.09
## wt   -0.87  0.89  0.66 -0.71  1.00 -0.17
## qsec  0.42 -0.43 -0.71  0.09 -0.17  1.00
</code></pre>

<p>创建图层：</p>

<pre><code class="language-r">g &lt;- ggplot(cormat_melt, aes(x=Var1, y=Var2))
</code></pre>

<p>在此基础上可添加的图层有：
* geom_tile(): 瓦片图
* geom_raster(): 光栅图，瓦片图的一种，只不过所有的tiles都是一样的大小</p>

<p>现在使用使用geom_tile()绘制相关性矩阵图，我们这里这绘制下三角矩阵图，首先要整理数据：</p>

<pre><code class="language-r">#获得相关矩阵的下三角
get_lower_tri &lt;- function(cormat){
  cormat[upper.tri(cormat)] &lt;- NA
  return(cormat)
}
#获得相关矩阵的上三角
get_upper_tri &lt;- function(cormat){
  cormat[lower.tri(cormat)] &lt;- NA
  return(cormat)
}
upper_tri &lt;- get_upper_tri(cormat = cormat)
head(upper_tri)
</code></pre>

<pre><code>##      mpg  disp    hp  drat    wt  qsec
## mpg    1 -0.85 -0.78  0.68 -0.87  0.42
## disp  NA  1.00  0.79 -0.71  0.89 -0.43
## hp    NA    NA  1.00 -0.45  0.66 -0.71
## drat  NA    NA    NA  1.00 -0.71  0.09
## wt    NA    NA    NA    NA  1.00 -0.17
## qsec  NA    NA    NA    NA    NA  1.00
</code></pre>

<p>绘制相关矩阵图</p>

<pre><code class="language-r">#数据重铸
upper_tri_melt &lt;- melt(upper_tri, na.rm = TRUE)
ggplot(data=upper_tri_melt, aes(Var1, y=Var2, fill=value))+
  geom_tile(color=&quot;white&quot;)+
  scale_fill_gradient2(low = &quot;blue&quot;, high = &quot;red&quot;, mid = &quot;white&quot;, midpoint = 0, limit=c(-1, 1), space = &quot;Lab&quot;, name=&quot;Person\nCorrelation&quot;)+
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, size = 12, hjust = 1))+
  coord_fixed()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/LL96JDbLi4.png?raw=true" alt="mark" /></p>

<blockquote>
<p>上图中蓝色代表互相关，红色代表正相关，至于coord_fixed()保证x，y轴比例为1</p>
</blockquote>

<p>可以看出上图顺序有点乱，我们可以对相关矩阵进行排序</p>

<pre><code class="language-r">#构造函数
reorder_cormat &lt;- function(cormat){
  dd &lt;- as.dist((1-cormat)/2)
  hc &lt;- hclust(dd)
  cormat &lt;- cormat[hc$order, hc$order]
}
cormat &lt;- reorder_cormat(cormat)
lower_tri &lt;- get_lower_tri(cormat)
lower_tri_melt &lt;- melt(lower_tri, na.rm = TRUE)
head(lower_tri_melt)
</code></pre>

<pre><code>##   Var1 Var2 value
## 1   hp   hp  1.00
## 2 disp   hp  0.79
## 3   wt   hp  0.66
## 4 qsec   hp -0.71
## 5  mpg   hp -0.78
## 6 drat   hp -0.45
</code></pre>

<p>绘制图形</p>

<pre><code class="language-r">ggheatmap &lt;- ggplot(lower_tri_melt, aes(Var1, Var2, fill=value))+
  geom_tile(color=&quot;white&quot;)+
  scale_fill_gradient2(low = &quot;blue&quot;, high = &quot;red&quot;, mid = &quot;white&quot;, midpoint = 0, limit=c(-1, 1), space = &quot;Lab&quot;, name=&quot;Person\nCorrelation&quot;)+
  theme_minimal()+
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 12, hjust = 1))+
 coord_fixed()
print(ggheatmap)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/FDdmmgjJL5.png?raw=true" alt="mark" /></p>

<h3 id="图元-多边形-路径-带状-射线-线段-矩形等">图元：多边形、路径、带状、射线（线段）、矩形等</h3>

<p>本节主要讲述的是添加图形元件，将用到一下函数：</p>

<ul>
<li>geom_polygon()：添加多边形</li>
<li>geom_path(): 路径</li>
<li>geom_ribbon(): 带状</li>
<li>geom_segment(): 射线、线段</li>
<li>geom_curve(): 曲线</li>
<li>geom_rect(): 二维矩形</li>
</ul>

<h4 id="添加多边形">添加多边形</h4>

<pre><code class="language-r">library(dplyr)
map_data(&quot;world&quot;)%&gt;%
  filter(region==c(&quot;China&quot;, &quot;Taiwan&quot;))%&gt;%
  ggplot(aes(x=long, y=lat, group=group))+
  geom_polygon(fill=&quot;red&quot;, color=&quot;black&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Gj3I6E4Kh6.png?raw=true" alt="mark" /></p>

<h4 id="添加路径-带状-矩形">添加路径、带状、矩形</h4>

<p>创建图层</p>

<pre><code class="language-r">h &lt;- ggplot(economics, aes(date, unemploy))
</code></pre>

<p>添加路径</p>

<pre><code class="language-r">h+geom_path()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/hKCeGeja0m.png?raw=true" alt="mark" /></p>

<p>添加带状</p>

<pre><code class="language-r">h+geom_ribbon(aes(ymin=unemploy-800, ymax=unemploy+800), fill = &quot;grey70&quot;)+geom_line(aes(y=unemploy))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/FKG84CB8f1.png?raw=true" alt="mark" /></p>

<p>添加矩形</p>

<pre><code class="language-r">h+
  geom_path()+
  geom_rect(aes(xmin=as.Date(&quot;1980-01-01&quot;), ymin=-Inf, xmax=as.Date(&quot;1985-01-01&quot;), ymax=Inf), fill=&quot;steelblue&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/c5iBDliiKB.png?raw=true" alt="mark" /></p>

<h4 id="添加线段">添加线段</h4>

<pre><code class="language-r">i &lt;- ggplot(mtcars, aes(wt, mpg))+geom_point()
#添加线段
i+geom_segment(aes(x=2, y=15, xend=3, yend=15))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/lF9GiCg023.png?raw=true" alt="mark" /></p>

<p>添加箭头</p>

<pre><code class="language-r">i+geom_segment(aes(x=5, y=30, xend=3.5, yend=25), arrow = arrow(length = unit(0.5, &quot;cm&quot;)))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/ebGE0KdHlc.png?raw=true" alt="mark" /></p>

<h4 id="添加曲线">添加曲线</h4>

<pre><code class="language-r">i+geom_curve(aes(x=2, y=15, xend=3, yend=15), color=&quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/BHJd8191Am.png?raw=true" alt="mark" /></p>

<h3 id="图形参数-主标题-坐标轴标签-图例标题">图形参数：主标题、坐标轴标签、图例标题</h3>

<p>创建图层</p>

<pre><code class="language-r">ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)
p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len))+geom_boxplot()
</code></pre>

<p>修改标题以及标签的函数有：</p>

<ul>
<li>ggtitle(&ldquo;New main title&rdquo;): 添加主标题</li>
<li>xlab(“New X axis label”): 修改x轴标签</li>
<li>ylab(“New Y axis label”): 修改y轴标签</li>
<li>labs(title = “New main title”, x = “New X axis label”, y = “New Y axis label”): 可同时添加主标题以及坐标轴标签，另外，图例标题也可以用此函数修改</li>
</ul>

<h4 id="修改主标题以及标签">修改主标题以及标签</h4>

<pre><code class="language-r">(p &lt;- p+labs(title=&quot;Plot of length\nby dose&quot;, x=&quot;Dose (mg)&quot;, y=&quot;teeth length&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/h0dhdgD0H5.png?raw=true" alt="mark" /></p>

<h4 id="修改标签属性-颜色-字体-大小等">修改标签属性：颜色、字体、大小等</h4>

<p>使用theme()修改,element_text()可以具体修改图形参数，element_blank()隐藏标签</p>

<pre><code class="language-r">#修改标签
p+theme(
plot.title = element_text(color = &quot;red&quot;, size = 14, face = &quot;bold.italic&quot;),
axis.title.x = element_text(color=&quot;blue&quot;, size = 14, face = &quot;bold&quot;),
axis.title.y = element_text(color=&quot;#993333&quot;, size = 14, face = &quot;bold&quot;)
)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/28K0J6j688.png?raw=true" alt="mark" /></p>

<pre><code>#隐藏标签
p+theme(
  plot.title = element_blank(),
  axis.title.x = element_blank(),
  axis.title.y = element_blank()
)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/0Fe5dGADJi.png?raw=true" alt="mark" /></p>

<h4 id="修改图例标题">修改图例标题</h4>

<pre><code class="language-r">p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len, fill=dose))+
  geom_boxplot()
p
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Afhm8Dbaa3.png?raw=true" alt="mark" /></p>

<pre><code>#修改图例标题
p+labs(fill=&quot;Dose (mg)&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/dLAe8a3a7K.png?raw=true" alt="mark" /></p>

<h3 id="图例位置以及外观">图例位置以及外观</h3>

<h4 id="修改图例位置以及外观">修改图例位置以及外观</h4>

<pre><code class="language-r">#图例位置在最上面，有五个选项：&quot;left&quot;,&quot;top&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;none&quot;
p+theme(legend.position = &quot;top&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/52gIJkL4Fj.png?raw=true" alt="mark" /></p>

<p>移除图例</p>

<pre><code class="language-r">p+theme(legend.position = &quot;none&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/akg12aak7l.png?raw=true" alt="mark" /></p>

<p>修改图例标题以及标签外观</p>

<pre><code class="language-r">p+theme(
  legend.title = element_text(color=&quot;blue&quot;),
  legend.text = element_text(color=&quot;red&quot;)
)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/7AgB3J5C56.png?raw=true" alt="mark" /></p>

<p>修改图例背景</p>

<pre><code class="language-r">p+theme(legend.background = element_rect(fill=&quot;lightblue&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/jB9CJj91hj.png?raw=true" alt="mark" /></p>

<h4 id="利用scale-函数自定义图例">利用scale()函数自定义图例</h4>

<p>主要两个函数：</p>

<ul>
<li>scale_x_discrete()：修改图例标签顺序</li>

<li><p>scale_fill_discrete(): 修改图例标题以及标签</p>

<pre><code class="language-r">#修改顺序
p+scale_x_discrete(limits=c(&quot;2&quot;, &quot;0.5&quot;, &quot;1&quot;))
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/AbFBaAl2a3.png?raw=true" alt="mark" /></p>

<pre><code>#修改标题以及标签
p+scale_fill_discrete(name=&quot;Dose&quot;, label=c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/AcKFcEl5j4.png?raw=true" alt="mark" /></p>

<h3 id="自动-手动修改颜色">自动/手动修改颜色</h3>

<pre><code class="language-r">mtcars$cyl &lt;- as.factor(mtcars$cyl)
</code></pre>

<p>创建图层</p>

<pre><code class="language-r"># boxplot
bp &lt;- ggplot(ToothGrowth, aes(x=dose, y=len))
# scatter plot
sp &lt;- ggplot(mtcars, aes(x=wt, y=mpg))
</code></pre>

<h4 id="修改填充色-轮廓线颜色">修改填充色、轮廓线颜色</h4>

<pre><code class="language-r">bp+geom_boxplot(fill=&quot;steelblue&quot;, color=&quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/L09ec6fJdi.png?raw=true" alt="mark" /></p>

<pre><code class="language-r">sp+geom_point(color=&quot;darkblue&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/dm838FcDID.png?raw=true" alt="mark" /></p>

<h4 id="通过映射分组修改颜色">通过映射分组修改颜色</h4>

<pre><code class="language-r">(bp &lt;- bp+geom_boxplot(aes(fill=dose)))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/39aG8c99CA.png?raw=true" alt="mark" /></p>

<pre><code>(sp &lt;- sp+geom_point(aes(color=cyl)))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/6lAKJH6FcI.png?raw=true" alt="mark" /></p>

<h4 id="手动修改颜色">手动修改颜色</h4>

<p>主要两个函数：</p>

<ul>
<li>scale_fill_manual(): 填充色</li>

<li><p>scale_color_manual()：轮廓色，如点线</p>

<pre><code class="language-r"># Box plot
bp + scale_fill_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/5l8CkJeG3b.png?raw=true" alt="mark" /></p>

<pre><code># Scatter plot
sp + scale_color_manual(values=c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/mlmKH9mDm0.png?raw=true" alt="mark" /></p>

<h4 id="使用-rcolorbrewer-调色板">使用<strong>RColorBrewer</strong>调色板</h4>

<ul>
<li>scale_fill_brewer(): 填充色</li>

<li><p>scale_color_brewer()：轮廓色，如点线</p>

<pre><code class="language-r"># Box plot
bp + scale_fill_brewer(palette=&quot;Dark2&quot;)
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/fdgD6lfCLK.png?raw=true" alt="mark" /></p>

<pre><code># Scatter plot
sp + scale_color_brewer(palette=&quot;Dark2&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/I4K7c25E00.png?raw=true" alt="mark" /></p>

<p><strong>RColorBrewer</strong>包提供以下调色板</p>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/2mh2le2j13.png?raw=true" alt="" /></p>

<p>还专门有一个灰度调色板：</p>

<pre><code class="language-r"># Box plot
bp + scale_fill_grey() + theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/el4C3gckcd.png?raw=true" alt="mark" /></p>

<pre><code># Scatter plot
sp + scale_color_grey() + theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/5B3cgiFbH6.png?raw=true" alt="mark" /></p>

<h4 id="梯度或连续颜色">梯度或连续颜色</h4>

<p>有时我们会将某个连续变量映射给颜色，这时修改这种梯度或连续型颜色就可以使用以下函数：</p>

<ul>
<li>scale_color_gradient(), scale_fill_gradient()：两种颜色的连续梯度</li>
<li>scale_color_gradient2(), scale_fill_gradient2()：不同梯度</li>

<li><p>scale_color_gradientn(), scale_fill_gradientn()：多种颜色梯度</p>

<pre><code class="language-r"># Color by qsec values
sp2&lt;-ggplot(mtcars, aes(x=wt, y=mpg)) +
geom_point(aes(color = qsec))
sp2
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DfKHLjH6mm.png?raw=true" alt="mark" /></p>

<pre><code># Change the low and high colors
# Sequential color scheme
sp2+scale_color_gradient(low=&quot;blue&quot;, high=&quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/g4mj6HBA2d.png?raw=true" alt="mark" /></p>

<pre><code># Diverging color scheme
mid&lt;-mean(mtcars$qsec)
sp2+scale_color_gradient2(midpoint=mid, low=&quot;blue&quot;, mid=&quot;white&quot;,
                          high=&quot;red&quot;, space = &quot;Lab&quot; )
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/jemKdg7ai2.png?raw=true" alt="mark" /></p>

<h3 id="点颜色-大小-形状">点颜色、大小、形状</h3>

<p>R提供的点形状是由数字表示的，具体如下：</p>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/g7gjFCb420.png?raw=true" alt="" /></p>

<pre><code class="language-r"># Basic scatter plot
ggplot(mtcars, aes(x=wt, y=mpg)) +
  geom_point(shape = 18, color = &quot;steelblue&quot;, size = 4)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/EG65iAcdaI.png?raw=true" alt="mark" /></p>

<pre><code># Change point shapes and colors by groups
ggplot(mtcars, aes(x=wt, y=mpg)) +
  geom_point(aes(shape = cyl, color = cyl))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/mKAb95CAk6.png?raw=true" alt="mark" /></p>

<p>可通过以下方法对点的颜色、大小、形状进行修改：</p>

<ul>
<li>scale_shape_manual() : to change point shapes</li>
<li>scale_color_manual() : to change point colors</li>

<li><p>scale_size_manual() : to change the size of points</p>

<pre><code class="language-r"># Change colors and shapes manually
ggplot(mtcars, aes(x=wt, y=mpg, group=cyl)) +
geom_point(aes(shape=cyl, color=cyl), size=2)+
scale_shape_manual(values=c(3, 16, 17))+
scale_color_manual(values=c('#999999','#E69F00', '#56B4E9'))+
theme(legend.position=&quot;top&quot;)
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Cj4aedai9j.png?raw=true" alt="mark" /></p>

<h3 id="文本注释-1">文本注释</h3>

<p>对图形进行文本注释有以下方法：</p>

<ul>
<li>geom_text(): 文本注释</li>
<li>geom_label(): 文本注释,类似于geom_text(),只是多了个背景框</li>
<li>annotate(): 文本注释</li>

<li><p>annotation_custom(): 分面时可以在所有的面板进行文本注释</p>

<pre><code class="language-r">set.seed(1234)
df &lt;- mtcars[sample(1:nrow(mtcars), 10), ]
df$cyl &lt;- as.factor(df$cyl)
</code></pre></li>
</ul>

<p>散点图注释</p>

<pre><code class="language-r"># Scatter plot
sp &lt;- ggplot(df, aes(x=wt, y=mpg))+ geom_point() 
# Add text, change colors by groups
sp + geom_text(aes(label = rownames(df), color = cyl),
               size = 3, vjust = -1)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/0EAk2aFEJG.png?raw=true" alt="mark" /></p>

<pre><code># Add text at a particular coordinate
sp + geom_text(x = 3, y = 30, label = &quot;Scatter plot&quot;,
              color=&quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/8A620eJKDl.png?raw=true" alt="mark" /></p>

<pre><code># geom_label()进行注释
sp + geom_label(aes(label=rownames(df)))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/D6ick1LI9i.png?raw=true" alt="mark" /></p>

<pre><code># annotation_custom(),需要用到textGrob()
library(grid)
# Create a text
grob &lt;- grobTree(textGrob(&quot;Scatter plot&quot;, x=0.1,  y=0.95, hjust=0,
  gp=gpar(col=&quot;red&quot;, fontsize=13, fontface=&quot;italic&quot;)))
# Plot
sp + annotation_custom(grob)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/80EK39ebBA.png?raw=true" alt="mark" /></p>

<pre><code>#分面注释
sp + annotation_custom(grob)+facet_wrap(~cyl, scales=&quot;free&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/cdfK8keKee.png?raw=true" alt="mark" /></p>

<h3 id="线型">线型</h3>

<p>R里的线型有七种：“blank”, “solid”, “dashed”, “dotted”, “dotdash”, “longdash”, “twodash”，对应数字0，1，2，3，4，5，6.</p>

<p>具体如下：</p>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/2gAL9gilee.png?raw=true" alt="" /></p>

<pre><code class="language-r"># Create some data
df2 &lt;- data.frame(sex = rep(c(&quot;Female&quot;, &quot;Male&quot;), each=3),
                  time=c(&quot;breakfeast&quot;, &quot;Lunch&quot;, &quot;Dinner&quot;),
                  bill=c(10, 30, 15, 13, 40, 17) )
head(df2)
</code></pre>

<pre><code>##      sex       time bill
## 1 Female breakfeast   10
## 2 Female      Lunch   30
## 3 Female     Dinner   15
## 4   Male breakfeast   13
## 5   Male      Lunch   40
## 6   Male     Dinner   17
</code></pre>

<pre><code class="language-r"># Line plot with multiple groups
# Change line types and colors by groups (sex)
ggplot(df2, aes(x=time, y=bill, group=sex)) +
  geom_line(aes(linetype = sex, color = sex))+
  geom_point(aes(color=sex))+
  theme(legend.position=&quot;top&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/leH2fj5jf7.png?raw=true" alt="mark" /></p>

<p>同点一样，线也可以类似修改：</p>

<ul>
<li>scale_linetype_manual() : to change line types</li>
<li>scale_color_manual() : to change line colors</li>

<li><p>scale_size_manual() : to change the size of lines</p>

<pre><code class="language-r"># Change line types, colors and sizes
ggplot(df2, aes(x=time, y=bill, group=sex)) +
geom_line(aes(linetype=sex, color=sex, size=sex))+
geom_point()+
scale_linetype_manual(values=c(&quot;twodash&quot;, &quot;dotted&quot;))+
scale_color_manual(values=c('#999999','#E69F00'))+
scale_size_manual(values=c(1, 1.5))+
theme(legend.position=&quot;top&quot;)
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/j9EajEBa9b.png?raw=true" alt="mark" /></p>

<h3 id="主题与背景颜色">主题与背景颜色</h3>

<pre><code class="language-r"># Convert the column dose from numeric to factor variable
ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)
</code></pre>

<p>创建箱线图</p>

<pre><code class="language-r">p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len))+
  geom_boxplot()
</code></pre>

<p>修改主题
<strong>ggplot2</strong>提供了好几种主题，另外有一个扩展包<strong>ggthemes</strong>专门提供了一主题，可以安装利用。</p>

<pre><code>install.packages(&quot;ggthemes&quot;)
</code></pre>

<ul>
<li>theme_gray(): gray background color and white grid lines</li>

<li><p>theme_bw() : white background and gray grid lines</p>

<pre><code class="language-r">p+theme_gray(base_size = 14)
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/hj1eIbED8J.png?raw=true" alt="mark" /></p>

<pre><code>p+theme_bw()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DIL3A3j3H0.png?raw=true" alt="mark" /></p>

<ul>
<li>theme_linedraw : black lines around the plot</li>

<li><p>theme_light : light gray lines and axis (more attention towards the data)</p>

<pre><code class="language-r">p + theme_linedraw()
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/dllCEkgbJd.png?raw=true" alt="mark" /></p>

<pre><code>p + theme_light()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/HIE1djID57.png?raw=true" alt="mark" /></p>

<ul>
<li>theme_minimal: no background annotations</li>

<li><p>theme_classic : theme with axis lines and no grid lines</p>

<pre><code class="language-r">p + theme_minimal()
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DldJFIi1jG.png?raw=true" alt="mark" /></p>

<pre><code>p + theme_classic()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/kdb786kHb6.png?raw=true" alt="mark" /></p>

<p><strong>ggthemes</strong>提供的主题</p>

<pre><code class="language-r">p+ggthemes::theme_economist()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/mhE0cglig4.png?raw=true" alt="mark" /></p>

<h4 id="坐标轴-最大最小值">坐标轴：最大最小值</h4>

<pre><code class="language-r">p &lt;- ggplot(cars, aes(x=speed, y=dist))+geom_point()
</code></pre>

<p>修改坐标轴范围有以下几种方式：
1、不删除数据</p>

<ul>
<li>p+coord_cartesian(xlim=c(5, 20), ylim=c(0, 50)):笛卡尔坐标系，这是设定修改不会删除数据</li>
</ul>

<p>2、会删除部分数据：不在此范围内的数据都会被删除,因此在此基础上添加图层时数据是不完整的</p>

<ul>
<li>p+xlim(5, 20)+ylim(0, 50)</li>
<li>p+scale_x_continuous(limits=c(5, 20))+scale_y_continuous(limits=c(0, 50))</li>
</ul>

<p>3、扩展图形范围：expand()函数，扩大范围</p>

<ul>
<li>p+expand_limits(x=0, y=0):设置截距为0，即过原点</li>
<li>p+expand_limits(x=c(5, 50), y=c(0, 150))：扩大坐标轴范围，这样图形显示就小了</li>
</ul>

<p>下面通过图形演示</p>

<pre><code class="language-r">p
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/45E5EkIbmH.png?raw=true" alt="mark" /></p>

<pre><code>#通过coord_cartesian()函数修改坐标轴范围
p+coord_cartesian(xlim =c (5, 20), ylim = c(0, 50))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/cbia8kk48E.png?raw=true" alt="mark" /></p>

<pre><code>#通过xlim()和ylim()函数修改
p+xlim(5, 20)+ylim(0, 50)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/cbia8kk48E.png?raw=true" alt="mark" /></p>

<pre><code>#expand limits
p+expand_limits(x=c(5, 50), y=c(0, 150))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/m44Dlla2Cl.png?raw=true" alt="mark" /></p>

<h4 id="坐标变换">坐标变换</h4>

<pre><code class="language-r">p &lt;- ggplot(cars, aes(x=speed, y=dist))+geom_point()
</code></pre>

<p>坐标变换有以下几种：</p>

<ul>
<li>p+scale_x_log10(),p+scale_y_log10(): 绘图时对x，y取10的对数</li>
<li>p+scale_x_sqrt(),p+scale_x_sqrt(): 开根号</li>
<li>p+scale_x_reverse(),p+scale_x_reverse()：坐标轴反向</li>
<li>p+coord_trans(x =“log10”, y=“log10”): 同上，可以对坐标轴取对数、根号等</li>
<li>p+scale_x_continuous(trans=&ldquo;log2&rdquo;),p+scale_x_continuous(trans=&ldquo;log2&rdquo;): 同上，取对数的另外一种方法</li>
</ul>

<p>下面实例演示：</p>

<pre><code class="language-r">p
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/90aD77ldKb.png?raw=true" alt="mark" /></p>

<pre><code class="language-r">p+scale_x_continuous(trans = &quot;log2&quot;)+
  scale_y_continuous(trans = &quot;log2&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/mI8LDhgJE9.png?raw=true" alt="mark" /></p>

<pre><code>#修改坐标刻度标签
require(scales)
p+scale_y_continuous(trans=log2_trans(),
                     breaks = trans_breaks(&quot;log2&quot;, function(x) 2^x),
                     labels=trans_format(&quot;log2&quot;, math_format(2^.x)))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/F94egDhaID.png?raw=true" alt="mark" /></p>

<pre><code>#坐标轴反向
p+scale_y_reverse()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/L68AbbdeH9.png?raw=true" alt="mark" /></p>

<h4 id="坐标刻度-刻度线-标签-顺序等">坐标刻度：刻度线、标签、顺序等</h4>

<p>更改坐标轴刻度线标签等函数：</p>

<ul>
<li>element_text(face, color, size, angle): 修改文本风格</li>

<li><p>element_blank(): 隐藏文本</p>

<pre><code class="language-r">(p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len))+geom_boxplot())
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/22F52FHA0H.png?raw=true" alt="mark" /></p>

<p>修改刻度标签等</p>

<pre><code class="language-r">p+theme(axis.text.x = element_text(face = &quot;bold&quot;, color=&quot;#993333&quot;, size=14, angle = 45),
        axis.text.y = element_text(face = &quot;bold&quot;, size = 14, color = &quot;blue&quot;, angle = 45))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/7k09a4DhDb.png?raw=true" alt="mark" /></p>

<p>移除刻度标签等</p>

<pre><code class="language-r">p + theme(
  axis.text.x = element_blank(), # Remove x axis tick labels
  axis.text.y = element_blank(), # Remove y axis tick labels
  axis.ticks = element_blank()) # Remove ticks
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/lmmg7BEa1m.png?raw=true" alt="mark" /></p>

<p>当然可以自定义坐标轴了</p>

<ul>
<li><p>离散非连续坐标轴</p>

<ul>
<li>scale_x_discrete(name, breaks, labels, limits)</li>
<li>scale_y_discrete(name, breaks, labels, limits)
<br /></li>
</ul></li>

<li><p>连续型坐标轴</p>

<ul>
<li>scale_x_conyinuous(name, breaks, labels, limits)</li>
<li>scale_y_continuous(name, breaks, labels, limits)
<br /></li>
</ul></li>
</ul>

<p>详细情况如下：</p>

<ul>
<li>name: x,y轴的标题</li>
<li>breaks: 刻度，分成几段</li>
<li>labels：坐标轴刻度线标签</li>
<li>limits: 坐标轴范围</li>
</ul>

<p>其中scale_xx()函数可以修改坐标轴的如下参数：</p>

<ul>
<li>坐标轴标题</li>
<li>坐标轴范围</li>
<li>刻度标签位置</li>
<li>手动设置刻度标签</li>
</ul>

<p>具体演示：</p>

<ul>
<li><p>离散坐标轴</p>

<pre><code class="language-r">#修改标签以及顺序
p+scale_x_discrete(name=&quot;Dose (mg)&quot;, limits=c(&quot;2&quot;, &quot;1&quot;, &quot;0.5&quot;))
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/EFbiHLHg4H.png?raw=true" alt="mark" /></p>

<pre><code class="language-r">#修改刻度标签
p+scale_x_discrete(breaks=c(&quot;0.5&quot;, &quot;1&quot;, &quot;2&quot;),labels=c(&quot;Dose 0.5&quot;, &quot;Dose 1&quot;, &quot;Dose 2&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/7b8a55d8e6.png?raw=true" alt="mark" /></p>

<pre><code class="language-r">#修改要显示的项
p+scale_x_discrete(limits=c(&quot;0.5&quot;, &quot;2&quot;))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/KEBgH9eL6A.png?raw=true" alt="mark" /></p>

<ul>
<li><p>连续型坐标轴</p>

<pre><code class="language-r">#散点图
(sp &lt;- ggplot(cars, aes(x=speed, y=dist))+geom_point())
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/6mAgGel8FI.png?raw=true" alt="mark" /></p></li>
</ul>

<p>修改坐标轴标签以及范围</p>

<pre><code class="language-r">(sp &lt;- sp+scale_x_continuous(name = &quot;Speed of cars&quot;, limits = c(0, 30))+
  scale_y_continuous(name = &quot;Stopping distance&quot;, limits = c(0, 150)))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/1Gfa1ki6jd.png?raw=true" alt="mark" /></p>

<p>更改y轴刻度，间隔50</p>

<pre><code class="language-r">sp+scale_y_continuous(breaks = seq(0, 150, 50))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/67LdJdeHJJ.png?raw=true" alt="mark" /></p>

<p>修改y轴标签为百分数</p>

<pre><code class="language-r">require(scales)
sp+scale_y_continuous(labels = percent)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/lKBLj42Fmb.png?raw=true" alt="mark" /></p>

<h3 id="添加直线-水平线-竖直线-回归线">添加直线：水平线、竖直线、回归线</h3>

<p><strong>ggplot2</strong>提供以下方法为图形添加直线：</p>

<ul>
<li>geom_hline(yintercept, linetype, color, size): 添加水平线</li>
<li>geom_vline(xintercept, linetype, color, size)：添加竖直线</li>
<li>geom_abline(intercept, slope, linetype, color, size)：添加回归线</li>
<li>geom_segment()：添加线段</li>
</ul>

<p>实例演示：</p>

<pre><code class="language-r">sp &lt;- ggplot(data=mtcars, aes(x=wt, y=mpg))+ geom_point()
</code></pre>

<p>添加直线：</p>

<pre><code class="language-r">#在y=20处添加一水平线，并设置颜色等
sp+geom_hline(yintercept = 20, linetype=&quot;dashed&quot;, color='red')
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/klELKdJ7h2.png?raw=true" alt="mark" /></p>

<pre><code>#在x=3处添加一竖直线，并设置颜色等
sp+geom_vline(xintercept = 3, color=&quot;blue&quot;, size=1.5)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/5cIFlhkK0E.png?raw=true" alt="mark" /></p>

<pre><code>#添加回归线
sp+geom_abline(intercept = 37, slope = -5, color=&quot;blue&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/Jci00jI819.png?raw=true" alt="mark" /></p>

<pre><code>#添加水平线段
sp+geom_segment(aes(x=2, y=15, xend=3, yend=15), color=&quot;red&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/1gAEcm93JF.png?raw=true" alt="mark" /></p>

<h3 id="图形旋转-旋转-反向">图形旋转：旋转、反向</h3>

<p>主要是下面两个函数：</p>

<ul>
<li>coord_flip()：创建水平方向图</li>

<li><p>scale_x_reverse(),scale_y_reverse()：坐标轴反向</p>

<pre><code class="language-r">set.seed(1234)
(hp &lt;- qplot(x=rnorm(200), geom = &quot;histogram&quot;))
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/CgC7HHLid5.png?raw=true" alt="mark" /></p>

<pre><code>#水平柱形图
hp+coord_flip()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/hD4HaiCDJI.png?raw=true" alt="mark" /></p>

<pre><code>#y轴反向
hp+scale_y_reverse()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/HCFl1ha75C.png?raw=true" alt="mark" /></p>

<h3 id="分面">分面</h3>

<p>分面就是根据一个或多个变量将图形分为几个图形以便于可视化，主要有两个方法实现：</p>

<ul>
<li>facet_grid()</li>

<li><p>facet_wrap()</p>

<pre><code class="language-r">ToothGrowth$dose &lt;- as.factor(ToothGrowth$dose)
(p &lt;- ggplot(ToothGrowth, aes(x=dose, y=len, group=dose))+
geom_boxplot(aes(fill=dose)))
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/3AfigK2AIl.png?raw=true" alt="mark" /></p>

<p>针对上面图形进行分面：</p>

<ul>
<li>p+facet_grid(supp~.): 按变量supp进行竖直方向分面</li>
<li>p+facet_grid(.~supp): 按变量supp进行水平方向分面</li>
<li>p+facet_wrap(dose~supp)：按双变量supp和dose进行水平竖直方向分面</li>
<li>p+facet_wrap(~fl): 将分成的面板边靠边置于一个矩形框内</li>
</ul>

<p>1、按一个离散变量进行分面：</p>

<pre><code class="language-r,fig.height=4,fig.width=3">#竖直方向进行分面
p+facet_grid(supp~.)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/e5hdDE7FE0.png?raw=true" alt="mark" /></p>

<pre><code>#水平方向分面
p+facet_grid(.~supp)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/F3BgFeHc3C.png?raw=true" alt="mark" /></p>

<p>2、按两个离散变量进行分面</p>

<pre><code class="language-r,fig.height=4,fig.width=3">#行按dose分面，列按supp分面
p+facet_grid(dose~supp)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/9112kbBA9g.png?raw=true" alt="mark" /></p>

<pre><code>#行按supp，列按dose分面
p+facet_grid(supp~dose)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/bjm9fk0k79.png?raw=true" alt="mark" /></p>

<p>从上面图形可以看出，每个面板的坐标轴比例都是一样的，我们可以通过设置参数scales来控制坐标轴比例</p>

<pre><code class="language-r">p + facet_grid(dose ~ supp, scales='free')
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/65F4K0ajaI.png?raw=true" alt="mark" /></p>

<h3 id="位置调整">位置调整</h3>

<p>很多图形需要我们调整位置，比如直方图时，由堆叠式、百分式、分离式等，具体的要通过实例说明</p>

<pre><code class="language-r">p &lt;- ggplot(mpg, aes(fl, fill=drv))
#直方图边靠边排列，参数position=&quot;dodge&quot;
p+geom_bar(position = &quot;dodge&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/13Cf1kA3Jc.png?raw=true" alt="mark" /></p>

<p>堆叠式position=&ldquo;stack&rdquo;</p>

<pre><code class="language-r">p+geom_bar(position = &quot;stack&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/J2bH42IjHA.png?raw=true" alt="mark" /></p>

<p>position=&ldquo;fill&rdquo;类似玉堆叠图，只不过按百分比排列，所有柱子都被标准化成同样高度</p>

<pre><code class="language-r">p+geom_bar(position = &quot;fill&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/1iblgciCm8.png?raw=true" alt="mark" /></p>

<p>position=&ldquo;jitter&rdquo;,（主要适用于散点图）增加扰动，避免重叠，前面讲的geom_jitter()就是来源于此</p>

<pre><code class="language-r">ggplot(mpg, aes(cty, hwy))+
  geom_point(position = &quot;jitter&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/01D9L4A8Ld.png?raw=true" alt="mark" /></p>

<p>上面几个函数有两个重要的参数：heigth、weight。</p>

<ul>
<li>position_dodge(width, height)</li>
<li>position_fill(width, height)</li>
<li>position_stack(width, height)</li>

<li><p>position_jitter(width, height)</p>

<pre><code class="language-r">p+geom_bar(position = position_dodge(width = 1))
</code></pre></li>
</ul>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DaHcfl9dId.png?raw=true" alt="mark" /></p>

<h3 id="坐标系">坐标系</h3>

<pre><code class="language-r">p &lt;- ggplot(mpg, aes(fl))+geom_bar()
</code></pre>

<p><strong>ggplot2</strong>中的坐标系主要有：</p>

<ul>
<li>p+coord_cartesian(xlim=NULL, ylim=NULL)：笛卡尔坐标系(默认)</li>
<li>p+coord_fixed(ratio=1, clim=NULL, ylim=NULL)：固定了坐标轴比例的笛卡尔坐标系。默认比例为1</li>
<li>p+coord_flip(&hellip;)：旋转笛卡尔坐标系</li>
<li>p+coord_polar(theta=&ldquo;x&rdquo;, start=0, direction=1)：极坐标系</li>
<li>p+coord_trans(x,y,limx,limy)：变换笛卡尔坐标系</li>
<li>coord_map()：地图坐标系</li>
</ul>

<p>各个坐标系参数如下：
1、笛卡尔坐标系：coord_cartesian(), coord_fixed() and coord_flip()</p>

<ul>
<li>xlim：x轴范围</li>
<li>ylim：y轴范围</li>
<li>ratio：y/x</li>
<li>&hellip;：其他参数</li>
</ul>

<p>2、极坐标系：coord_polar()</p>

<ul>
<li>theta：外延坐标，x或y</li>
<li>start：坐标开始的位置，默认为12点钟</li>
<li>direction：方向：顺时针(1),逆时针(-1)</li>
</ul>

<p>3、变换坐标系：coord_trans()</p>

<ul>
<li>x,y：变换的坐标轴</li>
<li>limx,limy：坐标轴范围</li>
</ul>

<p>实例演示：</p>

<pre><code class="language-r">p+coord_cartesian(ylim = c(0,200))
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/KE5JcFmdhl.png?raw=true" alt="mark" /></p>

<pre><code>p+coord_fixed(ratio = 1/50)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/LHeG17JljH.png?raw=true" alt="mark" /></p>

<pre><code>p+coord_flip()
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/8AK62ii9Ib.png?raw=true" alt="mark" /></p>

<pre><code class="language-r">p+coord_polar(theta = &quot;x&quot;, direction = 1)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/HBF135cLAA.png?raw=true" alt="mark" /></p>

<pre><code>p+coord_trans(y=&quot;sqrt&quot;)
</code></pre>

<p><img src="https://github.com/YTLogos/Pic_blog/blob/master/DhI4Ha1m91.png?raw=true" alt="mark" /></p>

<h2 id="ggplot2-包资料扩展-包-函数"><strong>ggplot2</strong>包资料扩展：包、函数</h2>

<ul>
<li><strong>ggplot2</strong>有一个官方网站，里面有十分详细的说明，<a href="http://ggplot2.tidyverse.org/reference/" target="_blank">点击这里直达</a></li>
<li><strong>ggplot2</strong>还有十分多的扩展包，<a href="https://www.ggplot2-exts.org/" target="_blank">点击这里直达</a></li>
</ul>

<h2 id="sessioninfo">SessionInfo</h2>

<pre><code class="language-r">sessionInfo()

## R version 3.4.1 (2017-06-30)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 16.04.3 LTS
## 
## Matrix products: default
## BLAS: /usr/lib/atlas-base/atlas/libblas.so.3.0
## LAPACK: /usr/lib/atlas-base/atlas/liblapack.so.3.0
## 
## locale:
##  [1] LC_CTYPE=zh_CN.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=zh_CN.UTF-8        LC_COLLATE=zh_CN.UTF-8    
##  [5] LC_MONETARY=zh_CN.UTF-8    LC_MESSAGES=zh_CN.UTF-8   
##  [7] LC_PAPER=zh_CN.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=zh_CN.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
## [1] scales_0.5.0   bindrcpp_0.2   dplyr_0.7.3    reshape2_1.4.2
## [5] maps_3.2.0     hexbin_1.27.1  plyr_1.8.4     ggplot2_2.2.1 
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.12        bindr_0.1           compiler_3.4.1     
##  [4] RColorBrewer_1.1-2  base64enc_0.1-3     tools_3.4.1        
##  [7] rpart_4.1-11        digest_0.6.12       checkmate_1.8.3    
## [10] htmlTable_1.9       evaluate_0.10.1     tibble_1.3.4       
## [13] gtable_0.2.0        lattice_0.20-35     pkgconfig_2.0.1    
## [16] rlang_0.1.2         Matrix_1.2-11       yaml_2.1.14        
## [19] gridExtra_2.3       stringr_1.2.0       knitr_1.17         
## [22] cluster_2.0.6       htmlwidgets_0.9     rprojroot_1.2      
## [25] nnet_7.3-12         glue_1.1.1          data.table_1.10.4  
## [28] R6_2.2.2            survival_2.41-3     foreign_0.8-69     
## [31] rmarkdown_1.6       latticeExtra_0.6-28 Formula_1.2-2      
## [34] magrittr_1.5        ggthemes_3.4.0      backports_1.1.0    
## [37] Hmisc_4.0-3         htmltools_0.3.6     MASS_7.3-47        
## [40] splines_3.4.1       assertthat_0.2.0    colorspace_1.3-2   
## [43] labeling_0.3        stringi_1.1.5       acepack_1.4.1      
## [46] lazyeval_0.2.0      munsell_0.4.3
</code></pre>
    </div>

    
<p class="edit-page">
  <a href="https://github.com/YTLogos/TaoYan/edit/master/content/post%5c2017-09-19.ggplot2%e9%ab%98%e6%95%88%e5%ae%9e%e7%94%a8%e6%8c%87%e5%8d%97.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>



    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/r/">R</a>
  
  <a class="badge badge-light" href="/tags/visualization/">visualization</a>
  
  <a class="badge badge-light" href="/tags/ggplot2/">ggplot2</a>
  
</div>



    
      








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hufa245e75a5e5fa47274790393ba89624_26717_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="https://taoyan.netlify.com">Tao Yan</a></h5>
      <h6 class="card-subtitle">PhD Candidate of Crop Science</h6>
      <p class="card-text" itemprop="description">My research interests covers a range of issues:Population Genetics Evolution and Ecotype Divergence Analysis of oilseed Rape, Genome-wide Association Study (GWAS) of Agronomic Traits.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
          <li>
            <a itemprop="sameAs" href="mailto:tyan@zju.edu.cn" >
              <i class="fas fa-paper-plane"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://twitter.com/TaoYANLogos" target="_blank" rel="noopener">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/YTLogos" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/post/2017-06-25.ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%88%A9%E7%94%A8ggplot2%E7%BB%98%E5%88%B6%E8%AF%AF%E5%B7%AE%E6%A3%92%E5%8F%8A%E6%98%BE%E8%91%97%E6%80%A7%E6%A0%87%E8%AE%B0/">ggplot2学习笔记系列之利用ggplot2绘制误差棒及显著性标记</a></li>
          
          <li><a href="/post/2017-06-25.ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E7%B3%BB%E5%88%97%E4%B9%8B%E4%B8%BB%E9%A2%98theme%E8%AE%BE%E7%BD%AE/">ggplot2学习笔记系列之主题（theme）设置</a></li>
          
          <li><a href="/post/2017-06-25.ggplot2%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%88%A9%E7%94%A8ggplot2%E7%BB%98%E5%88%B6%E6%9D%A1%E5%BD%A2%E5%9B%BE/">ggplot2学习笔记系列之利用ggplot2绘制条形图</a></li>
          
          <li><a href="/post/2017-09-14.%E5%88%9B%E5%BB%BA%E5%8F%8A%E8%87%AA%E5%AE%9A%E4%B9%89ggplot%E5%88%86%E9%9D%A2%E5%9B%BE%E5%BD%A2%E5%8F%82%E6%95%B0/">创建及自定义ggplot分面图形参数</a></li>
          
          <li><a href="/post/2017-09-10.r%E8%AF%AD%E8%A8%80%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">R语言可视化学习笔记之基因组数据可视化</a></li>
          
        </ul>
      </div>
      
    

    

    
<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "logos-1" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/css.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/bash.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/js.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/markdown.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/html.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    <script id="dsq-count-scr" src="https://logos-1.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.16bbb3750feb7244c9bc409a5a4fe678.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    &copy; Tao Yan, 2018-2019 &middot; 

    Made with <i class="far fa-heart" style="color:#E13D3D"></i>, <a href="https://github.com/YTLogos/TaoYan" target="_blank" rel="noopener"><i class="fas fa-code-branch" style="color:#E13D3D"></i></a>, the <a href="https://cran.r-project.org/" target="_blank" rel="noopener"><i class="fab fa-r-project"></i> </a><a href="https://github.com/rstudio/blogdown" target="_blank" rel="noopener">blogdown</a> package, and the 
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

<div style="text-align: center;"><script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5cz8zk3uynm&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"></script></div>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
